# üì± –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ HairCarePlus iOS –≤ Rider

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è iOS

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

1. –í –≤–∞—à–µ–º –æ–∫–Ω–µ **Run/Debug Configurations** –Ω–∞–∂–º–∏—Ç–µ `+`
2. –í—ã–±–µ—Ä–∏—Ç–µ `.NET Project`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   ```
   Name: HairCarePlus iOS Profile
   Project: src\Client\HairCarePlus.Client.Patient
   Platform type: iOS
   Configuration: Release (–≤–∞–∂–Ω–æ –¥–ª—è —Ç–æ—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫!)
   ```

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è iOS

–í —Ä–∞–∑–¥–µ–ª–µ **Extra mlaunch arguments** –¥–æ–±–∞–≤—å—Ç–µ:
```
--profiler --enable-background-fetch
```

### 3. –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

#### –°–ø–æ—Å–æ–± A: –ß–µ—Ä–µ–∑ –º–µ–Ω—é
1. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é "HairCarePlus iOS Profile"
2. –ù–∞–∂–º–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ –∫–Ω–æ–ø–∫–µ Run
3. –í—ã–±–µ—Ä–∏—Ç–µ `Profile with ‚Üí dotTrace`

#### –°–ø–æ—Å–æ–± B: –ß–µ—Ä–µ–∑ –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
- macOS: `Cmd+Shift+Alt+F11`
- Windows/Linux: `Ctrl+Shift+Alt+F11`

### 4. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ—è–≤–∏—Ç—Å—è –¥–∏–∞–ª–æ–≥. –í—ã–±–µ—Ä–∏—Ç–µ:

#### –î–ª—è –ø–µ—Ä–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ TodayPage:
```
Profiling type: Timeline
‚úÖ Collect call stacks every: 1 ms
‚úÖ Collect thread times
‚úÖ Collect memory traffic
‚úÖ Collect native memory allocations
```

#### –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
```
Profiling type: Sampling
Measure: Wall time (CPU and wait time)
Time measurement accuracy: High
```

### 5. –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è TodayPage

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
2. **–ù–∞—á–Ω–∏—Ç–µ –∑–∞–ø–∏—Å—å** (Start Recording –≤ –æ–∫–Ω–µ dotTrace)
3. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è:**
   - –û—Ç–∫—Ä–æ–π—Ç–µ TodayPage
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ 5-10 –¥–∞—Ç –ø–æ–¥—Ä—è–¥
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
   - –í—ã–ø–æ–ª–Ω–∏—Ç–µ long-press –Ω–∞ 3-4 –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
   - –û—Ç–º–µ—Ç—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏
4. **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–ø–∏—Å—å** (Stop Recording)

### 6. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –¥–ª—è iOS

#### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ iOS –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **Main Thread –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**
   - iOS –æ—á–µ–Ω—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º Main Thread
   - –õ—é–±–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è > 16ms –≤—ã–∑–æ–≤–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ª–∞–≥–∏

2. **Memory Pressure**
   - iOS –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–º—è—Ç—å—é
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Memory Traffic –≤ Timeline

3. **CollectionView Performance**
   - –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ `CalendarDays` –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º—É —Å–∫—Ä–æ–ª–ª—É
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Cell Reuse —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### 7. –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

#### Call Tree:
```
TodayViewModel
‚îú‚îÄ‚îÄ LoadTodayEventsAsync [< 50ms –Ω–∞ iOS] ‚úÖ
‚îú‚îÄ‚îÄ UpdateUIWithEvents [< 8ms] ‚úÖ
‚îú‚îÄ‚îÄ PreloadingService.PreloadAdjacentDatesAsync [—Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫] ‚úÖ
‚îî‚îÄ‚îÄ ConfettiManager.ShowConfettiAsync [< 30% CPU] ‚úÖ
```

#### Hot Spots –¥–ª—è iOS:
- üî¥ `UICollectionView` layout –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- üî¥ `SKConfettiView` —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
- üü° `ObservableCollection` —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- üü¢ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

### 8. –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã iOS

#### –ü—Ä–æ–±–ª–µ–º–∞: "No profiling data collected"
```bash
# –†–µ—à–µ–Ω–∏–µ 1: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
# –°–∏–º—É–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤—Å–µ –≤–∏–¥—ã –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

# –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Provisioning Profile
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å Development, –Ω–µ Distribution
```

#### –ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
```csharp
// –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä–µ:
// 1. –£—Ç–µ—á–∫–∏ –≤ event handlers
// 2. –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –≤ ViewModels
// 3. –ù–µ–∑–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ Messenger
```

### 9. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è iOS

–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

1. **–ï—Å–ª–∏ Main Thread > 90%:**
   - –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Ç—è–∂–µ–ª—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ñ–æ–Ω–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Task.Run` –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

2. **–ï—Å–ª–∏ –º–Ω–æ–≥–æ GC:**
   - –£–º–µ–Ω—å—à–∏—Ç–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –≤ `UpdateUIWithEvents`
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ object pooling –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

3. **–ï—Å–ª–∏ –ª–∞–≥–∞–µ—Ç —Å–∫—Ä–æ–ª–ª:**
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å layout –≤ CollectionView
   - –£–ø—Ä–æ—Å—Ç–∏—Ç–µ DataTemplate

### 10. –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

1. –í –æ–∫–Ω–µ dotTrace: `File ‚Üí Export ‚Üí Performance Report`
2. –í—ã–±–µ—Ä–∏—Ç–µ:
   - Format: HTML Report
   - Include: Call Tree, Hot Spots, Timeline
3. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å –∫–æ–º–∞–Ω–¥–æ–π –¥–ª—è code review 