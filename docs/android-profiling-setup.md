# ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è Android –≤ Rider

## –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. –í –ø–æ–ª–µ **Launch profile** –≤—ã–±–µ—Ä–∏—Ç–µ: `Android`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
   - **Target framework**: `net9.0-android`
   - **Runtime**: `<Automatic>` –∏–ª–∏ `Mono`

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

1. –ù–∞–∂–º–∏—Ç–µ `+` ‚Üí `.NET Launch Settings Profile`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   ```
   Name: HairCarePlus Android Profile
   Project: HairCarePlus.Client.Patient
   Launch Profile: Android
   ```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

#### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/—ç–º—É–ª—è—Ç–æ—Ä–∞

```bash
# –î–ª—è —ç–º—É–ª—è—Ç–æ—Ä–∞
adb shell setprop debug.mono.profile '127.0.0.1:9999'

# –í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
# Settings ‚Üí About ‚Üí Tap Build Number 7 times
# Settings ‚Üí Developer Options ‚Üí USB Debugging: ON
```

#### 2. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

–í **Environment variables** –¥–æ–±–∞–≤—å—Ç–µ:
```
MONO_PROFILE_OPTIONS=log:calls,alloc,output=profile.mlpd
ANDROID_ENABLE_PROFILING=true
DOTNET_CLI_TELEMETRY_OPTOUT=1
```

#### 3. –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

1. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–∫–æ–Ω–∫—É –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è (‚óê)
3. –í –¥–∏–∞–ª–æ–≥–µ –≤—ã–±–µ—Ä–∏—Ç–µ:
   ```
   Profiling type: Timeline
   ‚úÖ Collect Android traces
   ‚úÖ Collect managed allocations
   ‚úÖ Collect native allocations
   ```

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã Android

#### –û—à–∏–±–∫–∞: "No devices found"
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
adb devices

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ ADB
adb kill-server
adb start-server
```

#### –û—à–∏–±–∫–∞: "Failed to start profiling"
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ Debug mode
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ AndroidManifest.xml:
   ```xml
   <application android:debuggable="true" ...>
   ```

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è TodayPage –Ω–∞ Android

#### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:

1. **RecyclerView –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è ViewHolder
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

2. **–ü–∞–º—è—Ç—å**
   - Java heap –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
   - Native –ø–∞–º—è—Ç—å (–æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)

3. **Rendering**
   - GPU overdraw
   - Jank frames –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ

#### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Android:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¶–µ–ª–µ–≤–æ–µ –≤—Ä–µ–º—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ |
|-----------|--------------|-------------|
| LoadTodayEventsAsync | < 150ms | > 300ms |
| RecyclerView scroll | 60 FPS | < 30 FPS |
| Memory per item | < 1MB | > 2MB |
| Startup time | < 2s | > 4s |

### –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü–æ—Å–ª–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Timeline ‚Üí UI Thread**
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ > 16ms
   - –ò—â–∏—Ç–µ –∫—Ä–∞—Å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏

2. **Memory Traffic**
   - –ß–∞—Å—Ç—ã–µ GC = –ø—Ä–æ–±–ª–µ–º–∞
   - –†–∞—Å—Ç—É—â–∞—è –ø–∞–º—è—Ç—å = —É—Ç–µ—á–∫–∞

3. **Call Tree**
   - –§–æ–∫—É—Å –Ω–∞ –≤–∞—à –∫–æ–¥, –Ω–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π
   - –ò—â–∏—Ç–µ TodayViewModel –º–µ—Ç–æ–¥—ã 