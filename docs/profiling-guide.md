# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—é HairCarePlus –≤ Rider

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ Rider:**
   - File ‚Üí Settings ‚Üí Plugins
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: dotTrace, dotMemory, Dynamic Program Analysis

2. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø—Ä–æ–µ–∫—Ç:**
   ```bash
   # –°–æ–±–µ—Ä–∏—Ç–µ –≤ Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
   dotnet build -c Release
   ```

## üì± –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ .NET MAUI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –ú–µ—Ç–æ–¥ 1: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä Rider

#### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –∑–∞–ø—É—Å–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ `Run/Debug Configurations` (Edit Configurations...)
2. –ù–∞–∂–º–∏—Ç–µ `+` ‚Üí `.NET Project`
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ:
   ```
   Name: HairCarePlus Profile
   Project: HairCarePlus.Client.Patient
   Target Framework: net9.0-android (–∏–ª–∏ net9.0-ios)
   Configuration: Release
   ```

#### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

1. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
2. –ù–∞–∂–º–∏—Ç–µ –∏–∫–æ–Ω–∫—É –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è (‚óê) —Ä—è–¥–æ–º —Å Run
3. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:
   - **Timeline** - –¥–ª—è –æ–±—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
   - **Sampling** - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–∑–æ—Ä–∞
   - **Tracing** - –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

### –ú–µ—Ç–æ–¥ 2: –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

#### –î–ª—è Android:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
dotnet build -t:Run -f net9.0-android -c Release

# 2. –ù–∞–π–¥–∏—Ç–µ PID –ø—Ä–æ—Ü–µ—Å—Å–∞
adb shell ps | grep haircare

# 3. –í Rider: Run ‚Üí Attach Profiler to Process
# –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ PID
```

#### –î–ª—è iOS:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ/—Å–∏–º—É–ª—è—Ç–æ—Ä–µ
dotnet build -t:Run -f net9.0-ios -c Release

# 2. –í Rider: Run ‚Üí Attach Profiler to Process
# –í—ã–±–µ—Ä–∏—Ç–µ HairCarePlus.Client.Patient
```

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è TodayPage

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞:**
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –û—Ç–∫—Ä–æ–π—Ç–µ TodayPage
   - –ù–∞—á–Ω–∏—Ç–µ –∑–∞–ø–∏—Å—å (Start Recording)

2. **–î–µ–π—Å—Ç–≤–∏—è:**
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ –¥—Ä—É–≥—É—é –¥–∞—Ç—É
   - –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
   - –û—Ç–º–µ—Ç—å—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏

3. **–ê–Ω–∞–ª–∏–∑:**
   - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–ø–∏—Å—å
   - –ù–∞–π–¥–∏—Ç–µ –≤ Call Tree: `LoadTodayEventsAsync`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∞–ª–ª–æ–∫–∞—Ü–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–Ω–∏–º–∞—Ü–∏–∏ –∏ UI

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Timeline –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**
   ```
   Profiling Type: Timeline
   ‚úÖ Collect thread times
   ‚úÖ Collect UI freeze events
   ```

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ë—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–π—Ç–µ –¥–∞—Ç—ã
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ long-press –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö
   - –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–π—Ç–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å

## üìà –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è TodayPage:

#### 1. Call Tree Analysis
```
LoadTodayEventsAsync
‚îú‚îÄ‚îÄ Time: < 100ms ‚úÖ
‚îú‚îÄ‚îÄ Allocations: < 1MB ‚úÖ
‚îî‚îÄ‚îÄ Database calls: < 50ms ‚úÖ

UpdateUIWithEvents  
‚îú‚îÄ‚îÄ Time: < 16ms (60 FPS) ‚úÖ
‚îú‚îÄ‚îÄ UI thread blocking: 0ms ‚úÖ
‚îî‚îÄ‚îÄ Collection updates: < 5ms ‚úÖ
```

#### 2. Hot Spots (–ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–µ—Å—Ç–∞)
- üî¥ `CalendarDays` CollectionView –ø—Ä–æ–∫—Ä—É—Ç–∫–∞
- üü° `EventsForSelectedDate` –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- üü¢ `ToggleEventCompletionAsync` –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

### –ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

| –ú–µ—Ç—Ä–∏–∫–∞ | –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ |
|---------|-----------------|-------------|
| Frame time | < 16ms | > 33ms |
| Memory allocations/sec | < 1MB | > 5MB |
| GC pressure | < 5% | > 15% |
| UI thread blocking | 0ms | > 100ms |

## üõ†Ô∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º

### –ï—Å–ª–∏ LoadTodayEventsAsync > 200ms:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   ```csharp
   // –í –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä–µ –Ω–∞–π–¥–∏—Ç–µ:
   CalendarCacheService.TryGet // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å > 80% hit rate
   ```

2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã:**
   ```csharp
   // –ò—â–∏—Ç–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã:
   GetEventsForDateQuery // –î–æ–ª–∂–µ–Ω –±—ã—Ç—å 1 –Ω–∞ –¥–∞—Ç—É
   ```

### –ï—Å–ª–∏ UI –ª–∞–≥–∞–µ—Ç (< 60 FPS):

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–ª–ª–æ–∫–∞—Ü–∏–∏ –≤ UpdateUIWithEvents:**
   - CollectionUpdater –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã
   - –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤—ã—Ö ObservableCollection

2. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ Timeline:**
   - –ò—â–∏—Ç–µ –∫—Ä–∞—Å–Ω—ã–µ –ø–æ–ª–æ—Å—ã (UI freezes)
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Main Thread utilization

## üí° –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã

### 1. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏

```csharp
// –î–æ–±–∞–≤—å—Ç–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:
_performanceMonitor.StartTimer("PreloadAdjacentDates");
// ... –∫–æ–¥ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏
_performanceMonitor.StopTimer("PreloadAdjacentDates");
```

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–∏

–í Timeline –ø—Ä–æ—Ñ–∞–π–ª–µ—Ä–µ:
- –§–∏–ª—å—Ç—Ä: `ConfettiManager`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CPU usage –≤–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏
- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å < 30% –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ

### 3. –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

1. File ‚Üí Export Performance Report
2. –§–æ—Ä–º–∞—Ç: HTML –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
3. –í–∫–ª—é—á–∏—Ç–µ: Call Tree, Hot Spots, Timeline

## üö® –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–æ—Ñ–∞–π–ª–µ—Ä –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# Android: –≤–∫–ª—é—á–∏—Ç–µ –æ—Ç–ª–∞–¥–∫—É
adb shell setprop debug.mono.profile '127.0.0.1:9999'

# iOS: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
# –°–∏–º—É–ª—è—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–∞–≤–∞—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –º–µ—Ç–æ–¥–∞—Ö

1. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Project Properties:
   ```xml
   <PropertyGroup Condition="'$(Configuration)'=='Release'">
     <DebugSymbols>true</DebugSymbols>
     <DebugType>portable</DebugType>
   </PropertyGroup>
   ```

## üìä –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:

```yaml
# .github/workflows/performance.yml
- name: Run Performance Tests
  run: |
    dotnet tool install -g JetBrains.dotTrace.CommandLineTools
    dotTrace -- dotnet test --filter "Category=Performance"
    dotTrace report -o=perf-report.html snapshot.dtp
```

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [dotTrace Documentation](https://www.jetbrains.com/help/profiler/)
- [.NET MAUI Performance](https://docs.microsoft.com/en-us/dotnet/maui/fundamentals/performance)
- [Rider Performance Profiling](https://www.jetbrains.com/help/rider/Performance_Profiling.html) 