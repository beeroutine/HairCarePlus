<?xml version="1.0" encoding="utf-8"?>
<toolkit:Popup x:Class="HairCarePlus.Client.Patient.Features.Progress.Views.RestrictionStoriesPopup"
               xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               xmlns:models="clr-namespace:HairCarePlus.Client.Patient.Features.Progress.Domain.Entities"
               xmlns:commonViews="clr-namespace:HairCarePlus.Client.Patient.Common.Views"
               xmlns:conv="clr-namespace:HairCarePlus.Client.Patient.Features.Progress.Converters"
               x:DataType="models:RestrictionTimer"
               CanBeDismissedByTappingOutsideOfPopup="True">

    <toolkit:Popup.Resources>
        <ResourceDictionary>
            <conv:RestrictionIconConverter x:Key="RestrictionIconConverter" />
        </ResourceDictionary>
    </toolkit:Popup.Resources>

    <Grid BackgroundColor="#CC000000"
          HorizontalOptions="FillAndExpand"
          VerticalOptions="FillAndExpand">
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Tapped="OnBackgroundTapped" />
        </Grid.GestureRecognizers>

        <Border
            BackgroundColor="{AppThemeBinding Light={StaticResource SurfaceColor}, Dark={StaticResource OffBlack}}"
            Padding="24"
            StrokeShape="RoundRectangle 24"
            HorizontalOptions="Center"
            VerticalOptions="Center">
            <VerticalStackLayout Spacing="32">
                <!-- Кольцо прогресса с иконкой -->
                <Grid HeightRequest="120" WidthRequest="120" HorizontalOptions="Center">
                    <commonViews:SkiaProgressRing Progress="{Binding Progress}" Thickness="6"
                                                 HeightRequest="120" WidthRequest="120" />
                    <Image Source="{Binding IconType, Converter={StaticResource RestrictionIconConverter}}"
                           WidthRequest="56" HeightRequest="56"
                           HorizontalOptions="Center" VerticalOptions="Center">
                        <Image.Behaviors>
                            <toolkit:IconTintColorBehavior TintColor="White" />
                        </Image.Behaviors>
                    </Image>
                </Grid>
                
                <!-- Осталось X дней -->
                <Label Text="{Binding DaysRemaining, StringFormat='Осталось {0} дней'}"
                       FontSize="20"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalTextAlignment="Center" />
                
                <!-- Заголовок ограничения -->
                <Label Text="{Binding Title}"
                       FontSize="24"
                       FontAttributes="Bold"
                       TextColor="White"
                       HorizontalTextAlignment="Center"
                       HorizontalOptions="Center"
                       Margin="0,-8,0,0" />
                
                <!-- Подробное описание -->
                <Label Text="{Binding DetailedDescription}"
                       FontSize="16"
                       LineHeight="1.4"
                       TextColor="#B0B0B0"
                       HorizontalTextAlignment="Center"
                       Margin="16,8,16,0" />
                
                <!-- Инструкция закрытия -->
                <Label Text="Нажмите в любом месте, чтобы закрыть"
                       FontSize="14"
                       TextColor="#60FFFFFF"
                       HorizontalTextAlignment="Center"
                       Margin="0,16,0,0" />
            </VerticalStackLayout>
        </Border>
    </Grid>
</toolkit:Popup> 