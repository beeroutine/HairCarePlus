<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:views="clr-namespace:HairCarePlus.Client.Patient.Features.Calendar.Views"
             xmlns:viewmodels="clr-namespace:HairCarePlus.Client.Patient.Features.Calendar.ViewModels"
             xmlns:helpers="clr-namespace:HairCarePlus.Client.Patient.Features.Calendar.Helpers"
             x:Class="HairCarePlus.Client.Patient.Features.Calendar.Views.CalendarPage"
             Title="Календарь">
    
    <ContentPage.Resources>
        <ResourceDictionary>
            <helpers:HasItemsConverter x:Key="HasItemsConverter" />
            <helpers:EventTypeToColorConverter x:Key="EventTypeToColorConverter" />
            <helpers:EventTypeToBackgroundConverter x:Key="EventTypeToBackgroundConverter" />
            <helpers:IsNotRestrictionConverter x:Key="IsNotRestrictionConverter" />
            <helpers:IsRestrictionConverter x:Key="IsRestrictionConverter" />
            <helpers:EventTypeToLabelConverter x:Key="EventTypeToLabelConverter" />
            <helpers:BoolToCalendarViewConverter x:Key="BoolToCalendarViewConverter" />
            <helpers:BoolConverter x:Key="BoolConverter" />
            
            <Style x:Key="EventTitleStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextPrimaryColor}, Dark={StaticResource White}}" />
            </Style>
            
            <Style x:Key="EventDescriptionStyle" TargetType="Label">
                <Setter Property="FontSize" Value="14" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextSecondaryColor}, Dark={StaticResource Gray300}}" />
            </Style>
            
            <Style x:Key="EventTimeStyle" TargetType="Label">
                <Setter Property="FontSize" Value="12" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextSecondaryColor}, Dark={StaticResource Gray300}}" />
            </Style>
            
            <Style x:Key="EventCardStyle" TargetType="Frame">
                <Setter Property="BackgroundColor" Value="{AppThemeBinding Light={StaticResource BackgroundColor}, Dark={StaticResource Gray900}}" />
                <Setter Property="CornerRadius" Value="12" />
                <Setter Property="Padding" Value="16" />
                <Setter Property="Margin" Value="0,6" />
                <Setter Property="BorderColor" Value="{AppThemeBinding Light={StaticResource BorderColor}, Dark={StaticResource Gray600}}" />
                <Setter Property="HasShadow" Value="False" />
            </Style>

            <Style x:Key="ErrorMessageStyle" TargetType="Label">
                <Setter Property="TextColor" Value="{StaticResource ErrorColor}" />
                <Setter Property="FontSize" Value="14" />
                <Setter Property="HorizontalOptions" Value="Center" />
                <Setter Property="Margin" Value="16" />
            </Style>

            <Style x:Key="SubheaderStyle" TargetType="Label">
                <Setter Property="FontSize" Value="18" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextPrimaryColor}, Dark={StaticResource White}}" />
                <Setter Property="Margin" Value="0,0,0,8" />
            </Style>
            
            <Style x:Key="DateHeaderStyle" TargetType="Label">
                <Setter Property="FontSize" Value="20" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource PrimaryDark}}" />
                <Setter Property="Margin" Value="0,0,0,8" />
            </Style>
            
            <Style x:Key="NoEventsStyle" TargetType="Label">
                <Setter Property="FontSize" Value="14" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextSecondaryColor}, Dark={StaticResource Gray300}}" />
                <Setter Property="HorizontalOptions" Value="Center" />
                <Setter Property="VerticalOptions" Value="Center" />
                <Setter Property="Margin" Value="0,16" />
            </Style>
            
            <Style x:Key="EventTypeBadgeStyle" TargetType="Border">
                <Setter Property="Padding" Value="6,2" />
                <Setter Property="StrokeThickness" Value="0" />
                <Setter Property="StrokeShape" Value="RoundRectangle 10,10,10,10" />
                <Setter Property="HorizontalOptions" Value="Start" />
                <Setter Property="Margin" Value="0,0,0,6" />
            </Style>
            
            <Style x:Key="EventTypeLabelStyle" TargetType="Label">
                <Setter Property="FontSize" Value="11" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="White" />
            </Style>
            
            <Style x:Key="DateRangeStyle" TargetType="Label">
                <Setter Property="FontSize" Value="12" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextSecondaryColor}, Dark={StaticResource Gray300}}" />
                <Setter Property="Margin" Value="0,4,0,0" />
            </Style>
            
            <Style x:Key="ViewModeButtonStyle" TargetType="Button">
                <Setter Property="BackgroundColor" Value="Transparent" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource PrimaryDark}}" />
                <Setter Property="FontSize" Value="14" />
                <Setter Property="Padding" Value="12,6" />
                <Setter Property="CornerRadius" Value="16" />
                <Setter Property="BorderColor" Value="{AppThemeBinding Light={StaticResource PrimaryColor}, Dark={StaticResource PrimaryDark}}" />
                <Setter Property="BorderWidth" Value="1" />
            </Style>
            
            <Style x:Key="TimeOfDayHeaderStyle" TargetType="Label">
                <Setter Property="FontSize" Value="16" />
                <Setter Property="FontAttributes" Value="Bold" />
                <Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource TextPrimaryColor}, Dark={StaticResource White}}" />
                <Setter Property="Margin" Value="0,16,0,8" />
            </Style>
            
            <Style x:Key="TimeOfDayIconStyle" TargetType="Label">
                <Setter Property="FontSize" Value="24" />
                <Setter Property="FontFamily" Value="MaterialIcons" />
                <Setter Property="Margin" Value="0,0,8,0" />
                <Setter Property="VerticalOptions" Value="Center" />
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,*" Padding="8">
        <!-- Переключатель вида -->
        <Grid IsVisible="{Binding IsMonthViewVisible, Converter={StaticResource BoolConverter}, ConverterParameter=false}">
            <Button Text="‹ Назад"
                    Command="{Binding BackToMonthViewCommand}"
                    HorizontalOptions="Start"
                    StyleClass="Text"/>
            
            <Label Text="{Binding SelectedDateText}"
                   FontSize="18"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"/>
        </Grid>

        <!-- Контейнер для месячного вида -->
        <Border Grid.Row="1" 
                Stroke="{AppThemeBinding Light={StaticResource Gray300}, Dark={StaticResource Gray700}}"
                StrokeThickness="1"
                StrokeShape="RoundRectangle 8,8,8,8"
                Padding="8"
                IsVisible="{Binding IsMonthViewVisible}">
            <views:MonthCalendarView x:Name="monthCalendarView"/>
        </Border>
        
        <!-- Контейнер для дневного вида -->
        <ScrollView Grid.Row="1"
                    IsVisible="{Binding IsMonthViewVisible, Converter={StaticResource BoolConverter}, ConverterParameter=false}">
            <VerticalStackLayout Padding="16">
                <Label Text="События на сегодня:" 
                       Style="{StaticResource SubheaderStyle}"/>
                
                <!-- Заглушка для отсутствия событий -->
                <Label Text="На этот день нет запланированных событий"
                       Style="{StaticResource NoEventsStyle}"
                       HorizontalOptions="Center"
                       Margin="0,32"/>
                
                <!-- Здесь будет список событий на выбранный день -->
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage> 