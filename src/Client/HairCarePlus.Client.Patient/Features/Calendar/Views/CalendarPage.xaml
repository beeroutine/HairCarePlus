<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:HairCarePlus.Client.Patient.Features.Calendar.ViewModels"
             xmlns:scheduler="clr-namespace:Syncfusion.Maui.Scheduler;assembly=Syncfusion.Maui.Scheduler"
             xmlns:core="clr-namespace:Syncfusion.Maui.Core;assembly=Syncfusion.Maui.Core"
             x:Class="HairCarePlus.Client.Patient.Features.Calendar.Views.CalendarPage"
             x:DataType="viewmodels:CalendarViewModel"
             Title="Календарь восстановления"
             BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray950}}">

    <Grid RowDefinitions="Auto,*">
        <!-- Progress Card -->
        <Frame Grid.Row="0" 
               Margin="15,15,15,5" 
               Padding="15" 
               BorderColor="Transparent"
               BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Primary}}"
               CornerRadius="15"
               HasShadow="True">
            <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="Auto,*,Auto">
                <!-- Phase Icon -->
                <Frame Grid.Row="0" 
                       Grid.RowSpan="3" 
                       Grid.Column="0"
                       HeightRequest="60" 
                       WidthRequest="60"
                       CornerRadius="30"
                       Padding="0"
                       Margin="0,0,15,0"
                       BorderColor="Transparent"
                       BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource Gray900}}"
                       VerticalOptions="Center">
                    <Label Text="&#xf200;" 
                           FontFamily="FontAwesome"
                           FontSize="24"
                           TextColor="{StaticResource Primary}"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"/>
                </Frame>
                
                <!-- Phase Text -->
                <Label Grid.Row="0" 
                       Grid.Column="1"
                       Text="{Binding CurrentPhaseText}" 
                       FontSize="18" 
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource White}}"/>
                
                <!-- Progress Text -->
                <Label Grid.Row="1" 
                       Grid.Column="1"
                       Text="{Binding ProgressText}" 
                       FontSize="14"
                       TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource White}}"/>
                
                <!-- Progress Bar -->
                <ProgressBar Grid.Row="2" 
                             Grid.Column="1"
                             Progress="{Binding ProgressPercentage}" 
                             ProgressColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource White}}"
                             HeightRequest="8"
                             Margin="0,5,0,0"/>
                
                <!-- Percentage -->
                <Label Grid.Row="0" 
                       Grid.RowSpan="3"
                       Grid.Column="2"
                       Text="{Binding ProgressPercentage, StringFormat='{0:P0}'}" 
                       FontSize="20" 
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource White}}"
                       VerticalOptions="Center"/>
            </Grid>
        </Frame>

        <!-- Calendar View with Tabs -->
        <Grid Grid.Row="1" RowDefinitions="Auto,*">
            <!-- Picker -->
            <Picker Grid.Row="0"
                    Margin="15,5,15,0"
                    SelectedIndex="{Binding SelectedViewIndex, Mode=TwoWay}"
                    BackgroundColor="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource Gray800}}"
                    TextColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource Primary}}">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>Месяц</x:String>
                        <x:String>Неделя</x:String>
                        <x:String>День</x:String>
                        <x:String>Список</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- Calendar Placeholder (Replacing Syncfusion Scheduler) -->
            <VerticalStackLayout Grid.Row="1" 
                                 Margin="15,10,15,0" 
                                 HorizontalOptions="Center" 
                                 VerticalOptions="Center">
                <Label Text="Календарь будет доступен здесь"
                       FontSize="18"
                       HorizontalOptions="Center"
                       TextColor="{AppThemeBinding Light={StaticResource Gray900}, Dark={StaticResource Gray100}}"/>
                <Label Text="Выберите вид календаря выше"
                       FontSize="14"
                       Margin="0,10,0,0"
                       HorizontalOptions="Center"
                       TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray400}}"/>
            </VerticalStackLayout>
        </Grid>
        
        <!-- Floating Action Button -->
        <Button Grid.Row="1"
                Text="+"
                FontSize="24"
                WidthRequest="60"
                HeightRequest="60"
                CornerRadius="30"
                HorizontalOptions="End"
                VerticalOptions="End"
                Margin="0,0,20,20"
                BackgroundColor="{StaticResource Primary}"
                Command="{Binding AddEventCommand}"/>
    </Grid>
</ContentPage> 