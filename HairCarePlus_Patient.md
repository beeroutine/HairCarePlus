# HairCarePlus Patient Mobile Application

## Общее описание
HairCarePlus Patient - это мобильное приложение на базе .NET MAUI, предназначенное для пациентов клиник трансплантации волос. Приложение обеспечивает полное сопровождение пациента в постоперационный период, включая календарь процедур, коммуникацию с клиникой и управление медиа-контентом.

## Архитектура

### Основные принципы
- Clean Architecture с четким разделением слоев
- MVVM (Model-View-ViewModel)
- DDD (Domain-Driven Design)
- SOLID принципы
- Модульная структура на основе функциональных возможностей (Features)
- Инверсия зависимостей через интерфейсы и DI

### Структура проекта
```
HairCarePlus.Client.Patient/
├── Features/                    # Основные функциональные модули
│   ├── Calendar/               # Календарь процедур и событий
│   │   ├── Domain/            # Доменный слой календаря
│   │   │   ├── Entities/     # Доменные сущности
│   │   │   │   └── HairTransplantEvent.cs
│   │   │   └── Repositories/ # Интерфейсы репозиториев
│   │   │       └── ICalendarRepository.cs
│   │   ├── Services/         # Доменные сервисы
│   │   ├── ViewModels/       # Логика представлений
│   │   └── Views/           # UI компоненты
│   ├── Chat/                  # Модуль чата
│   │   ├── Domain/
│   │   │   ├── Entities/
│   │   │   │   └── ChatMessage.cs
│   │   │   └── Repositories/
│   │   │       └── IChatRepository.cs
│   │   ├── ViewModels/
│   │   └── Views/
│   └── Notifications/         # Модуль уведомлений
├── Infrastructure/            # Инфраструктурный слой
│   ├── Storage/              # Базовая инфраструктура хранения
│   │   ├── AppDbContext.cs   # Контекст базы данных
│   │   ├── Migrations/       # Миграции EF Core
│   │   └── LocalStorageService.cs  # Базовый сервис хранилища
│   ├── Features/             # Реализации репозиториев
│   │   ├── Calendar/
│   │   │   └── CalendarRepository.cs
│   │   └── Chat/
│   │       └── ChatRepository.cs
│   ├── Security/
│   │   └── SecureStorageService.cs
│   └── Media/
│       └── FileSystemService.cs
├── Common/                    # Общие компоненты и утилиты
├── ViewModels/                # Базовые ViewModel'и
├── Effects/                   # Эффекты MAUI
├── Resources/                 # Ресурсы приложения
└── Platforms/                 # Платформо-зависимый код
```

### Доменный слой (Features)
#### Сущности и контракты
1. **Calendar.Domain.Entities**
   - `HairTransplantEvent` - чистая доменная модель события
   - Определение бизнес-правил и валидации
   - Отсутствие зависимостей от инфраструктуры

2. **Calendar.Domain.Repositories**
   - `ICalendarRepository` - контракт доступа к данным
   - Определение необходимых CRUD-операций
   - Специализированные методы поиска и фильтрации

### Инфраструктурный слой
#### База данных
1. **Storage/AppDbContext**
   - Конфигурация EF Core
   - Определение маппингов через ModelBuilder
   - Управление миграциями

2. **Features/Calendar/CalendarRepository**
   - Реализация ICalendarRepository
   - Работа с EF Core и DbContext
   - Управление транзакциями
   - Реализация специфичных запросов

#### Базовые сервисы
1. **LocalStorageService**
   - Инициализация базы данных
   - Управление миграциями
   - Предоставление транзакций
   - Общее управление хранилищем

2. **SecureStorageService**
   - Шифрование данных
   - Управление ключами
   - Безопасное хранение

3. **FileSystemService**
   - Работа с медиафайлами
   - Управление кэшем
   - Очистка временных файлов

### Dependency Injection
```csharp
// MauiProgram.cs
builder.Services
    .AddDbContext<AppDbContext>()
    .AddScoped<ICalendarRepository, CalendarRepository>()
    .AddScoped<IChatRepository, ChatRepository>()
    .AddSingleton<ILocalStorageService, LocalStorageService>()
    .AddSingleton<ISecureStorageService, SecureStorageService>();
```

## Основные модули

### 1. Calendar (Календарь)
#### Назначение
- Управление расписанием процедур и событий
- Отслеживание прогресса восстановления
- Напоминания о важных процедурах

#### Компоненты
- **Domain/**
  - Entities/HairTransplantEvent.cs - доменная модель
  - Repositories/ICalendarRepository.cs - контракт хранилища
- **Services/**
  - HairTransplantEventGenerator - генерация событий
- **ViewModels/**
  - TodayViewModel - логика главного экрана
  - CalendarViewModel - управление календарём

### 2. Chat (Чат)
#### Назначение
- Мгновенная связь с клиникой
- Обмен сообщениями и медиафайлами
- История коммуникаций

#### Особенности
- Локальное хранение истории чата
- Поддержка различных типов сообщений
- Статусы доставки и прочтения

### 3. Notifications (Уведомления)
#### Назначение
- Информирование о предстоящих процедурах
- Напоминания о необходимых действиях
- Системные уведомления

## Инфраструктура

### Хранение данных
- SQLite для локального хранения
- SecureStorage для конфиденциальных данных
- Файловое хранилище для медиаконтента

### Синхронизация
- Двунаправленная синхронизация с сервером
- Очередь операций для офлайн-режима
- Разрешение конфликтов

### Безопасность
- JWT аутентификация
- Шифрование локальных данных
- Безопасное хранение учетных данных

## UI/UX особенности

### Дизайн
- Современный минималистичный интерфейс
- Поддержка светлой и темной тем
- Адаптивный дизайн для различных устройств

### Цветовая схема
- Основные цвета:
  - Лекарства/процедуры: #4B9BF8
  - Осмотры/визиты: #A0DAB2
  - Фотоотчёты: #9747FF
  - Видео-инструкции: #FF9F1C
  - Общие рекомендации: #8E8E93
  - Критические предупреждения: #F14336

## Технические характеристики

### Требования к системе
- iOS 14+ или Android 7.0+
- Минимум 100MB свободного места
- Камера для фотоотчетов
- Интернет-подключение для синхронизации

### Производительность
- Быстрый запуск приложения (<2 секунды)
- Плавная навигация между экранами
- Эффективное использование памяти
- Оптимизированная работа с базой данных

## Текущие ограничения
1. Офлайн-режим ограничен 30 днями истории
2. Максимальный размер медиафайла - 50MB
3. Хранение истории чата ограничено 1000 сообщениями

## Планы развития
1. Интеграция с носимыми устройствами
2. Расширение функционала календаря
3. Улучшение алгоритмов синхронизации
4. Добавление голосовых сообщений в чат

## Рекомендации по разработке
1. Следовать принципам Clean Architecture
2. Использовать MVVM паттерн
3. Писать unit-тесты для бизнес-логики
4. Документировать публичные API
5. Соблюдать правила именования 